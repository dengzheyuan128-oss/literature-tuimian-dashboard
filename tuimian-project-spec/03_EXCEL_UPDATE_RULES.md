# Excel 驱动更新规则

> 状态：**已冻结** - 基于2026-01-17纠偏优化  
> 适用对象：所有执行院校补齐任务的AI账号

---

## 一、核心原则

### 原则1：覆盖率优先于精确度

> **第一目标是"所有院校都进入名录"，而不是"所有院校都有推免通知页"。**

- 是否进入 `universities.json` 是第一层目标
- linkGrade / yearStatus 属于第二层目标

### 原则2：两阶段补齐，而非一次性做到位

Excel院校补齐任务**必须拆分为两个阶段执行**：
- **阶段A**：覆盖型补齐（强制先做）
- **阶段B**：精修型补齐（限量执行）

---

## 二、阶段A：覆盖型补齐（强制先做）

### 2.1 阶段目标

- 将Excel中所有院校**补齐为JSON条目**
- 不追求推免通知页
- 快速、安全、低积分消耗

### 2.2 可接受的最低入口（任一即可）

只要满足"稳定可访问"，即可写入：

- 学校**研究生院 / 研招网**首页
- **文学院**官方主页
- 学校**招生信息 / 招生公告**栏目页

> ❗ 不要求当页出现"推免"字样

### 2.3 字段填写规则（阶段A）

```json
{
  "name": "院校名称",
  "tier": null,  // 禁止填写，保持null
  "disciplineGrade": "从Excel读取",
  "programs": [
    {
      "programName": "中国语言文学",
      "notices": [
        {
          "year": 2026,
          "title": "研究生招生信息",  // 或"文学院主页"等描述性标题
          "url": "稳定入口URL",
          "linkGrade": "B",  // 统一填B
          "sourceType": "list_page",  // 或homepage
          "yearStatus": "unverified",  // 统一填unverified
          "lastVerifiedAt": "2026-01-17"
        }
      ]
    }
  ]
}
```

### 2.4 搜索与停损规则

**每校最多尝试2类入口**：
1. 研究生院 / 研招入口
2. 文学院入口

**停损规则**：
- 两类入口均无法确认 → 立即停止搜索
- 写入 `06_PENDING_MANUAL.md`
- ❌ **禁止通过不断更换关键词继续搜索**

### 2.5 搜索策略示例

```
第一次尝试：
- 关键词："XX大学 研究生院" 或 "XX大学 研招网"
- 目标：找到研究生院官网首页

第二次尝试（第一次失败时）：
- 关键词："XX大学 文学院" 或 "XX大学 中文系"
- 目标：找到文学院官网首页

两次均失败：
- 停止搜索
- 记录到pending_manual
```

---

## 三、阶段B：精修型补齐（限量执行）

### 3.1 阶段目标

- 为**少量高价值院校**定位明确的推免相关页面
- 提供用户体验示范区

### 3.2 可进入阶段B的院校范围

**仅限**：
- 学科评估 A- / B+ / B
- 且用户关注度高（985 / 211 / 热门地域）

> 具体名单由负责人确认

### 3.3 阶段B的升级规则

- 找到"当年推免通知正文页 / 推免列表页" → 可考虑 **B+ 或 A**
- 仅找到栏目页 / 往年通知 → 维持 **B + unverified**

> 所有A级升级必须在提交说明中给出证据说明

---

## 四、关于tier的强制约束（重要）

### 4.1 禁止行为

- ❌ **禁止自动推断并写入tier**
- tier属于：
  - 主观判断
  - 产品层逻辑

### 4.2 如需记录判断依据

可新增字段（可选）：
- `tierNote`：文本备注
- `tierRationale`：判断依据

**用途**：
- 仅作备注，不参与排序与匹配
- 供人工决策时参考

---

## 五、批次执行与反馈要求

### 5.1 批次原则

- 允许分批执行
- 每一批完成后**必须暂停等待负责人审核**

### 5.2 强制产出差分反馈

每批次完成后，需额外提供一份差分说明（Markdown文件）：

**文件命名**：`reports/excel_fill_batch_X.md`

**必须包含**：
- 新增院校条目数
- 成功写入稳定入口数
- `pending_manual` 数量
- 代表性卡点（2-3个）
- 对下一批的策略建议

**示例模板**：
```markdown
# 阶段A第X批补齐报告

## 执行概况
- 目标院校数：15所
- 成功补齐：12所
- pending_manual：3所

## 成功案例
1. 首都师范大学：找到研究生院首页
2. 北京语言大学：找到文学院主页
...

## 失败案例与卡点
1. XX大学：研招网改版，入口不稳定
2. XX大学：文学院无独立官网
...

## 下批策略建议
- 优先处理有独立文学院的院校
- 对于综合性大学，优先找研招网
```

---

## 六、GitHub提交规范（补充）

### 6.1 提交原则

- 一次提交只做一件事（一个批次）
- commit message需包含：
  - 本批目标
  - 阶段（A / B）
  - 是否涉及linkGrade升级

### 6.2 Commit Message模板

```
[data] 阶段A第X批院校补齐（XX所）

- 阶段：A（覆盖型补齐）
- 目标院校数：XX所
- 成功补齐：XX所
- pending_manual：XX所
- 变更范围：universities.json, 06_PENDING_MANUAL.md
- 是否影响既有结构：否
- 是否需要人工复核：是（见reports/excel_fill_batch_X.md）

院校清单：
- 院校1（B级，研招网首页）
- 院校2（B级，文学院主页）
- ...
```

---

## 七、明确禁止的行为（红线）

- ❌ 为提高完成率而无限搜索
- ❌ 将"看起来像官方"的页面直接升级为A
- ❌ 自动生成或写入tier
- ❌ 在一次提交中混合阶段A与阶段B行为
- ❌ 跳过差分报告直接提交

---

## 八、Excel文件处理规范

### 8.1 Excel列映射

| Excel列 | JSON字段 | 处理规则 |
|---------|----------|----------|
| 学校名称 | name | 直接映射 |
| 评选结果 | disciplineGrade | 直接映射 |
| 学校代码 | - | 不存储 |
| 序号 | - | 不存储 |

### 8.2 缺失字段处理

Excel中**没有tier字段**，处理规则：
- 新增院校的tier字段**统一填null**
- 不尝试推断或自动填充
- 等待人工确认后再填写

---

## 九、成本控制目标

### 9.1 阶段A成本预期

- 每校预期成本：1-3积分
- 第一批（15所）：15-45积分
- 全部56所：56-168积分

### 9.2 超支停损

单批次如果出现：
- 平均每校成本 > 5积分
- pending_manual比例 > 40%

应立即暂停，报告负责人调整策略。

---

## 结语

> **院校名录是一个长期维护资产，不是一次性"做完"的任务。**

通过"两阶段补齐 + 明确停损"，可以在控制成本的同时，让覆盖率、可信度与可维护性同时成立。

本规则用于替代此前模糊的逐校线性搜索假设。

---

## 修订记录

- 2026-01-17：初版建立，整合冻结建议稿
