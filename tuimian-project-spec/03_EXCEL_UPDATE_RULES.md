# Excel驱动院校补齐与搜索规则

> 状态：执行规则  
> 最后更新：2026-01-17

## 核心原则

**Excel是院校范围与最低完成度的约束清单，不是完全锁死信息来源。**

Manus的职责：
1. 以Excel为院校全集基准
2. 主动补齐缺失院校
3. 进行有限度、目标明确的初步搜索

---

## 执行流程

### Step 1: 院校范围确认

1. 读取Excel中的院校列表
2. 对比 `universities.json` 中已有院校
3. 生成缺失院校清单

---

### Step 2: 补齐缺失院校（受限搜索）

对于每个缺失院校：

#### 2.1 搜索目标

找到该校**最可能正确**的官方推免/研究生招生信息入口

#### 2.2 搜索范围限制

- 学校官网
- 研究生院官网
- 文学院官网
- **不超过3次明确搜索尝试**

#### 2.3 搜索成功的处理

将链接写入 `universities.json`，默认标注：
```json
{
  "linkGrade": "B",
  "yearStatus": "unverified"
}
```

**不要求当次即达到A级**

#### 2.4 搜索失败或不确定的处理

1. 标记该院校为 `pending_manual`
2. 在 `06_PENDING_MANUAL.md` 中记录：
   - 学校名称
   - 已尝试的入口
   - 未确认原因（未发布/结构混乱/信息缺失）
3. **立即停止进一步搜索**
4. 转交人工处理

---

## 明确禁止的行为

❌ **无限搜索**：超过3次尝试后必须停止  
❌ **跨站点猜测**：不得访问非官方域名  
❌ **强行补链接**：不确定时不得填写URL  
❌ **自行深挖A级**：初次搜索只需找到B级入口

---

## Excel字段映射规则

### 必填字段
- 院校名称 → `name`
- 梯队 → `tier`

### 可选字段
- 学科评估 → `disciplineGrade`
- 推免链接 → `url`
- 年份 → `year`

### 映射规则

1. **仅更新Excel中明确出现的字段**
2. **不对Excel未给出的信息进行"补猜"**
3. 如果Excel某行信息不足以完成映射：
   - 标记为 `pending_manual`
   - 不得自行搜索补全

---

## 人工提供链接的处理流程

当你人工提供链接时：

1. Manus验证链接（访问页面）
2. 根据 `02_NOTICE_GRADE_RULES.md` 判定等级
3. 更新 `universities.json`
4. 提交到GitHub

**不进行额外搜索，只验证和更新。**

---

## 资源消耗控制

### 停止搜索的触发条件

单个院校搜索资源消耗 > 5积分时：
1. 立即停止
2. 标记为 `pending_manual`
3. 上报转接人工

### 积分估算参考

- 访问1个页面 ≈ 1积分
- 搜索1次 ≈ 1-2积分
- 3次尝试上限 ≈ 5积分

---

## 批量更新的提交规范

### 单次提交范围

- 建议：10-20所院校/次
- 最多：不超过30所/次

### Commit Message 模板

```
[data] 补齐Excel中缺失的XX所院校

- 变更范围：universities.json
- 新增院校：XX所
- pending_manual：XX所
- 是否影响既有结构：否
- 是否需要人工复核：是（见06_PENDING_MANUAL.md）
```

---

## 修订记录

- 2026-01-17：初版建立
